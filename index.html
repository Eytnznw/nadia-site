<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>נדיה - המרחב הבטוח שלך</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;700;900&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Heebo', sans-serif;
            background-color: #f0f4f8;
            overflow-x: hidden;
        }
        /* Custom Animations */
        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.98) translateY(10px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }
        .page-enter {
            animation: fadeInScale 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
        
        /* Glassmorphism Utilities */
        .glass {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        .glass-dark {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .gradient-bg {
            background: radial-gradient(circle at 50% 0%, #3b82f6 0%, #1e3a8a 100%);
        }
        
        /* Custom Scrollbar for Chat */
        .chat-scroll::-webkit-scrollbar {
            width: 6px;
        }
        .chat-scroll::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        .chat-scroll::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // --- Icons ---
        const Icons = {
            Home: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>,
            Book: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>,
            Sparkles: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L12 3Z"/></svg>,
            Message: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>,
            Mail: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>,
            Settings: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>,
            Menu: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="4" y1="12" x2="20" y2="12"/><line x1="4" y1="6" x2="20" y2="6"/><line x1="4" y1="18" x2="20" y2="18"/></svg>,
            X: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
            Shield: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>,
            Heart: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>,
            Search: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
        };

        // --- Context ---
        const AppContext = React.createContext();

        // --- Pages Components ---

        // 1. HOME PAGE
        const HomePage = ({ setPage }) => (
            <div className="page-enter text-center py-10 px-4">
                <div className="max-w-4xl mx-auto">
                    <div className="mb-10 inline-block p-4 rounded-full bg-blue-50 text-blue-600 shadow-inner">
                        <Icons.Shield />
                    </div>
                    <h1 className="text-5xl md:text-7xl font-black text-slate-900 mb-6 tracking-tight">
                        נדיה <span className="text-blue-600">.</span>
                    </h1>
                    <p className="text-xl md:text-2xl text-slate-500 mb-12 max-w-2xl mx-auto leading-relaxed">
                        המרחב שלך להבין, להתחזק ולחזור לעצמך. <br/>
                        אנחנו כאן כדי לתת שם לתחושות ולכלים להתמודד.
                    </p>
                    
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto">
                        <button onClick={() => setPage('topics')} className="group p-8 bg-white rounded-2xl shadow-xl shadow-slate-200/50 border border-slate-100 hover:border-blue-500 hover:shadow-blue-500/10 transition-all duration-300 transform hover:-translate-y-1">
                            <div className="w-12 h-12 bg-blue-100 text-blue-600 rounded-xl flex items-center justify-center mb-4 mx-auto group-hover:bg-blue-600 group-hover:text-white transition-colors">
                                <Icons.Book />
                            </div>
                            <h3 className="text-xl font-bold mb-2">ללמוד את המושגים</h3>
                            <p className="text-slate-400 text-sm">מה זה גזלייטינג? הפצצת אהבה? בואי נבין את השפה.</p>
                        </button>
                        
                        <button onClick={() => setPage('ai')} className="group p-8 bg-gradient-to-br from-indigo-600 to-blue-700 text-white rounded-2xl shadow-xl shadow-blue-500/30 hover:shadow-blue-600/40 transition-all duration-300 transform hover:-translate-y-1 relative overflow-hidden">
                            <div className="absolute inset-0 bg-white/10 opacity-0 group-hover:opacity-20 transition-opacity"></div>
                            <div className="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center mb-4 mx-auto backdrop-blur-sm">
                                <Icons.Sparkles />
                            </div>
                            <h3 className="text-xl font-bold mb-2">העוזר החכם</h3>
                            <p className="text-blue-100 text-sm">ניתוח הודעות, סימולציות ותשובות בזמן אמת עם AI.</p>
                        </button>

                        <button onClick={() => setPage('contact')} className="group p-8 bg-white rounded-2xl shadow-xl shadow-slate-200/50 border border-slate-100 hover:border-green-500 hover:shadow-green-500/10 transition-all duration-300 transform hover:-translate-y-1">
                            <div className="w-12 h-12 bg-green-100 text-green-600 rounded-xl flex items-center justify-center mb-4 mx-auto group-hover:bg-green-600 group-hover:text-white transition-colors">
                                <Icons.Mail />
                            </div>
                            <h3 className="text-xl font-bold mb-2">דברו איתי</h3>
                            <p className="text-slate-400 text-sm">אנחנו כאן להקשיב. שלחי הודעה ונתחיל בשיחה.</p>
                        </button>
                    </div>
                </div>
            </div>
        );

        // 2. TOPICS PAGE
        const TopicsPage = () => {
            const topics = [
                { title: "הפצצת אהבה", desc: "מחמאות ומתנות מוגזמות בהתחלה כדי ליצור תלות מהירה.", color: "bg-pink-50 text-pink-600" },
                { title: "גזלייטינג", desc: "ערעור תפיסת המציאות שלך ('את מדמיינת', 'זה לא קרה').", color: "bg-purple-50 text-purple-600" },
                { title: "שילוש (Triangulation)", desc: "הכנסת צלע שלישית כדי ליצור קנאה ותחרותיות.", color: "bg-orange-50 text-orange-600" },
                { title: "האבן האפורה", desc: "להיות משעממת וחסרת רגש כדי להפסיק לספק 'דלק' לנרקיסיסט.", color: "bg-gray-100 text-gray-600" },
                { title: "הקופים המעופפים", desc: "אנשים שהנרקיסיסט מגייס כדי לפגוע בך בשמו.", color: "bg-yellow-50 text-yellow-600" },
                { title: "הפחתת ערך", desc: "ירידות, ביקורת וזלזול שמגיעים אחרי שלב האידיאליזציה.", color: "bg-red-50 text-red-600" },
            ];

            return (
                <div className="page-enter max-w-5xl mx-auto px-4 py-8">
                    <h2 className="text-3xl font-bold mb-8 text-center text-slate-800">המדריך המקוצר</h2>
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        {topics.map((t, i) => (
                            <div key={i} className="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 hover:shadow-md transition">
                                <div className={`inline-block px-3 py-1 rounded-full text-xs font-bold mb-4 ${t.color}`}>מושג #{i+1}</div>
                                <h3 className="text-xl font-bold text-slate-800 mb-2">{t.title}</h3>
                                <p className="text-slate-600">{t.desc}</p>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        // 3. AI TOOLS PAGE (ENHANCED)
        const AIToolsPage = () => {
            const { apiKey, setShowSettings } = React.useContext(AppContext);
            const [input, setInput] = React.useState("");
            const [messages, setMessages] = React.useState([{ type: 'bot', text: 'היי, אני העוזר של נדיה. בחרי באחד הכלים למעלה כדי להתחיל.' }]);
            const [loading, setLoading] = React.useState(false);
            const [mode, setMode] = React.useState('analyze'); // analyze, greyrock, validate

            const tools = [
                { id: 'analyze', label: 'ניתוח הודעה', icon: <Icons.Search />, prompt: 'Act as an expert on narcissism. Analyze the following text received by the user. Identify manipulation tactics like gaslighting, guilt-tripping, or projection. Explain simply in Hebrew.' },
                { id: 'greyrock', label: 'תגובת אבן אפורה', icon: <Icons.Shield />, prompt: 'The user needs to respond to a narcissist using the "Grey Rock" method (boring, unemotional, brief). Generate 3 optional Hebrew responses to the following text:' },
                { id: 'validate', label: 'האם אני משתגעת?', icon: <Icons.Heart />, prompt: 'Act as a compassionate therapist. The user feels confused or crazy due to potential gaslighting. Validate their feelings, offer a reality check, and support them based on this text. Respond in Hebrew.' }
            ];

            const currentTool = tools.find(t => t.id === mode);

            const handleSend = async () => {
                if (!input.trim()) return;
                
                if (!apiKey) {
                    setShowSettings(true);
                    return;
                }

                const userMsg = input;
                setMessages(prev => [...prev, { type: 'user', text: userMsg }]);
                setInput("");
                setLoading(true);

                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: `${currentTool.prompt} User text: "${userMsg}"` }] }]
                        })
                    });
                    const data = await response.json();
                    const botReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "אירעה שגיאה. בדקי את המפתח.";
                    setMessages(prev => [...prev, { type: 'bot', text: botReply }]);
                } catch (e) {
                    setMessages(prev => [...prev, { type: 'bot', text: "שגיאת תקשורת. בדקי את החיבור או המפתח." }]);
                } finally {
                    setLoading(false);
                }
            };

            const chatEndRef = React.useRef(null);
            React.useEffect(() => {
                chatEndRef.current?.scrollIntoView({ behavior: "smooth" });
            }, [messages]);

            return (
                <div className="page-enter max-w-4xl mx-auto px-4 py-4 h-[calc(100vh-140px)] flex flex-col">
                    
                    {/* Mode Selector */}
                    <div className="flex gap-2 mb-4 overflow-x-auto pb-2">
                        {tools.map(tool => (
                            <button 
                                key={tool.id}
                                onClick={() => setMode(tool.id)}
                                className={`flex items-center gap-2 px-4 py-3 rounded-xl transition-all whitespace-nowrap border ${mode === tool.id ? 'bg-blue-600 text-white border-blue-600 shadow-lg shadow-blue-500/30' : 'bg-white text-slate-600 border-slate-200 hover:bg-slate-50'}`}
                            >
                                {tool.icon}
                                <span className="font-bold">{tool.label}</span>
                            </button>
                        ))}
                    </div>

                    <div className="bg-white rounded-3xl shadow-xl border border-slate-200 flex-1 flex flex-col overflow-hidden">
                        <div className="bg-slate-50 p-4 border-b border-slate-200 flex justify-between items-center">
                            <div className="flex items-center gap-2">
                                <div className="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                                <span className="font-bold text-slate-700 text-sm">נדיה AI &bull; {currentTool.label}</span>
                            </div>
                            {!apiKey && <button onClick={() => setShowSettings(true)} className="text-xs bg-red-100 text-red-600 px-3 py-1 rounded-full font-bold">הגדר מפתח</button>}
                        </div>
                        
                        <div className="flex-1 overflow-y-auto p-4 space-y-6 bg-slate-50/50 chat-scroll">
                            {messages.map((m, i) => (
                                <div key={i} className={`flex ${m.type === 'user' ? 'justify-start' : 'justify-end'}`}>
                                    <div className={`max-w-[85%] p-4 rounded-2xl shadow-sm ${m.type === 'user' 
                                        ? 'bg-white text-slate-800 border border-slate-200 rounded-br-none' 
                                        : 'bg-gradient-to-br from-blue-600 to-indigo-600 text-white rounded-bl-none'}`}>
                                        <div className="whitespace-pre-wrap leading-relaxed text-sm md:text-base">{m.text}</div>
                                    </div>
                                </div>
                            ))}
                            {loading && (
                                <div className="flex justify-end">
                                    <div className="bg-white p-3 rounded-2xl rounded-bl-none shadow-sm border border-slate-100 flex gap-1">
                                        <div className="w-2 h-2 bg-slate-400 rounded-full animate-bounce"></div>
                                        <div className="w-2 h-2 bg-slate-400 rounded-full animate-bounce delay-100"></div>
                                        <div className="w-2 h-2 bg-slate-400 rounded-full animate-bounce delay-200"></div>
                                    </div>
                                </div>
                            )}
                            <div ref={chatEndRef} />
                        </div>

                        <div className="p-4 bg-white border-t border-slate-100">
                            <div className="flex gap-2">
                                <input 
                                    type="text" 
                                    value={input}
                                    onChange={(e) => setInput(e.target.value)}
                                    onKeyPress={(e) => e.key === 'Enter' && handleSend()}
                                    placeholder={mode === 'analyze' ? "הדביקי הודעה לניתוח..." : mode === 'greyrock' ? "למה צריך להגיב?" : "מה את מרגישה?"}
                                    className="flex-1 bg-slate-100 border-none rounded-xl px-4 py-3 focus:ring-2 focus:ring-blue-500 outline-none"
                                />
                                <button onClick={handleSend} disabled={loading} className="bg-blue-600 text-white p-3 rounded-xl hover:bg-blue-700 transition disabled:opacity-50 shadow-lg shadow-blue-500/30">
                                    <Icons.Sparkles />
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // 4. CONTACT PAGE
        const ContactPage = () => {
            const { contactEmail, setShowSettings } = React.useContext(AppContext);
            const [status, setStatus] = React.useState("idle");

            const handleSubmit = async (e) => {
                e.preventDefault();
                if (!contactEmail) { setShowSettings(true); return; }
                setStatus("submitting");
                
                // Form submission logic (simulated for UI)
                const formData = new FormData(e.target);
                const data = Object.fromEntries(formData.entries());
                
                try {
                     await fetch(`https://formsubmit.co/ajax/${contactEmail}`, {
                        method: "POST",
                        headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
                        body: JSON.stringify({ ...data, _subject: `הודעה חדשה: ${data.name}`, _captcha: "false" })
                    });
                    setStatus("success");
                } catch { setStatus("error"); }
            };

            return (
                <div className="page-enter max-w-lg mx-auto px-4 py-10">
                    <div className="bg-white p-8 rounded-3xl shadow-xl border border-slate-100 text-center">
                        <div className="w-16 h-16 bg-blue-50 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-6">
                            <Icons.Mail />
                        </div>
                        <h2 className="text-2xl font-bold text-slate-800 mb-2">אנחנו כאן בשבילך</h2>
                        <p className="text-slate-500 mb-8 text-sm">השאירי פרטים ונחזור אליך בהקדם האפשרי.</p>
                        
                        {status === "success" ? (
                            <div className="bg-green-50 text-green-700 p-4 rounded-xl animate-fadeIn">ההודעה נשלחה בהצלחה!</div>
                        ) : (
                            <form onSubmit={handleSubmit} className="space-y-4 text-right">
                                <input name="name" required placeholder="שם מלא" className="w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 focus:ring-2 focus:ring-blue-500 outline-none transition" />
                                <input name="email" required type="email" placeholder="אימייל" className="w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 focus:ring-2 focus:ring-blue-500 outline-none transition" />
                                <textarea name="message" required rows="4" placeholder="ההודעה שלך..." className="w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 focus:ring-2 focus:ring-blue-500 outline-none transition"></textarea>
                                
                                <button type="submit" disabled={status === "submitting"} className="w-full bg-slate-900 text-white font-bold py-4 rounded-xl hover:bg-slate-800 transition shadow-lg transform hover:-translate-y-1">
                                    {status === "submitting" ? "שולח..." : "שליחת הודעה"}
                                </button>
                                
                                {!contactEmail && <p className="text-xs text-red-400 text-center cursor-pointer" onClick={() => setShowSettings(true)}>⚠️ יש להגדיר מייל בהגדרות</p>}
                            </form>
                        )}
                    </div>
                </div>
            );
        };

        // 5. FAQ Page
        const FAQPage = () => {
             const faqs = [
                { q: "למה הם עושים את זה?", a: "בבסיס ההפרעה עומדת תחושת ערך עצמי נמוכה וריקות. הגרנדיוזיות היא מנגנון הגנה לפיצוי על בושה." },
                { q: "האם זה ישתנה?", a: "נדיר מאוד. ללא מודעות עצמית ורצון עז לטיפול, הדפוסים נוטים לחזור על עצמם." },
            ];
            
            return (
                <div className="page-enter max-w-3xl mx-auto px-4 py-10">
                    <h2 className="text-3xl font-bold mb-8 text-center text-slate-800">שאלות נפוצות</h2>
                    <div className="space-y-4">
                        {faqs.map((f, i) => (
                            <div key={i} className="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                                <h3 className="font-bold text-lg text-slate-800 mb-2">{f.q}</h3>
                                <p className="text-slate-600">{f.a}</p>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        // --- Main Layout ---
        const SettingsModal = ({ close }) => {
            const { apiKey, setApiKey, contactEmail, setContactEmail } = React.useContext(AppContext);
            const [localKey, setLocalKey] = React.useState(apiKey);
            const [localEmail, setLocalEmail] = React.useState(contactEmail);

            const save = () => {
                setApiKey(localKey);
                setContactEmail(localEmail);
                localStorage.setItem("nadia_api", localKey);
                localStorage.setItem("nadia_email", localEmail);
                close();
            };

            return (
                <div className="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 page-enter">
                    <div className="bg-white rounded-3xl w-full max-w-md p-6 shadow-2xl">
                        <div className="flex justify-between items-center mb-6">
                            <h3 className="font-bold text-xl">הגדרות</h3>
                            <button onClick={close} className="p-2 hover:bg-slate-100 rounded-full"><Icons.X /></button>
                        </div>
                        <div className="space-y-4 mb-6">
                            <div>
                                <label className="text-sm font-bold text-slate-700 block mb-1">Gemini API Key</label>
                                <input type="password" value={localKey} onChange={e => setLocalKey(e.target.value)} className="w-full border rounded-xl px-3 py-2 bg-slate-50" placeholder="הדבק מפתח כאן..." />
                            </div>
                            <div>
                                <label className="text-sm font-bold text-slate-700 block mb-1">אימייל לקבלת פניות</label>
                                <input type="email" value={localEmail} onChange={e => setLocalEmail(e.target.value)} className="w-full border rounded-xl px-3 py-2 bg-slate-50" placeholder="המייל שלך..." />
                            </div>
                        </div>
                        <button onClick={save} className="w-full bg-blue-600 text-white font-bold py-3 rounded-xl hover:bg-blue-700">שמור וסגור</button>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [page, setPage] = React.useState('home');
            const [showSettings, setShowSettings] = React.useState(false);
            const [isMenuOpen, setIsMenuOpen] = React.useState(false);
            
            // State for Context
            const [apiKey, setApiKey] = React.useState(localStorage.getItem("nadia_api") || "AIzaSyAekRlMPfrivHyP-NC3SXUGL5kxkAJ3LXE");
            const [contactEmail, setContactEmail] = React.useState(localStorage.getItem("nadia_email") || "nadia.levyb@gmail.com");

            const navItems = [
                { id: 'home', label: 'ראשי', icon: <Icons.Home /> },
                { id: 'topics', label: 'מושגים', icon: <Icons.Book /> },
                { id: 'ai', label: 'AI כלים', icon: <Icons.Sparkles /> },
                { id: 'faq', label: 'שאלות', icon: <Icons.Message /> },
                { id: 'contact', label: 'צור קשר', icon: <Icons.Mail /> },
            ];

            return (
                <AppContext.Provider value={{ apiKey, setApiKey, contactEmail, setContactEmail, setShowSettings }}>
                    <div className="min-h-screen flex flex-col font-sans text-slate-900">
                        {/* Header */}
                        <header className="sticky top-0 z-40 glass">
                            <div className="max-w-7xl mx-auto px-4 h-16 flex items-center justify-between">
                                <div className="flex items-center gap-2 cursor-pointer" onClick={() => setPage('home')}>
                                    <div className="w-8 h-8 bg-blue-600 text-white rounded-lg flex items-center justify-center shadow-lg shadow-blue-500/30">
                                        <span className="font-black">נ</span>
                                    </div>
                                    <span className="font-bold text-xl tracking-tight hidden md:block">נדיה</span>
                                </div>

                                {/* Desktop Nav */}
                                <nav className="hidden md:flex items-center gap-1 bg-slate-100/50 p-1 rounded-full border border-white/50">
                                    {navItems.map(item => (
                                        <button 
                                            key={item.id}
                                            onClick={() => setPage(item.id)}
                                            className={`px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 flex items-center gap-2 ${page === item.id ? 'bg-white text-blue-600 shadow-sm' : 'text-slate-500 hover:text-slate-900'}`}
                                        >
                                            {item.icon} {item.label}
                                        </button>
                                    ))}
                                </nav>

                                <div className="flex items-center gap-2">
                                    <button className="md:hidden p-2 text-slate-600" onClick={() => setIsMenuOpen(!isMenuOpen)}><Icons.Menu /></button>
                                </div>
                            </div>
                        </header>

                        {/* Mobile Nav Drawer */}
                        {isMenuOpen && (
                            <div className="md:hidden bg-white border-b p-4 animate-fadeIn">
                                <div className="flex flex-col gap-2">
                                    {navItems.map(item => (
                                        <button key={item.id} onClick={() => { setPage(item.id); setIsMenuOpen(false); }} className={`p-3 rounded-xl text-right flex items-center gap-3 ${page === item.id ? 'bg-blue-50 text-blue-600 font-bold' : 'text-slate-600'}`}>
                                            {item.icon} {item.label}
                                        </button>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Main Content Area */}
                        <main className="flex-grow relative">
                            {page === 'home' && <HomePage setPage={setPage} />}
                            {page === 'topics' && <TopicsPage />}
                            {page === 'ai' && <AIToolsPage />}
                            {page === 'contact' && <ContactPage />}
                            {page === 'faq' && <FAQPage />}
                        </main>

                        {/* Footer */}
                        <footer className="py-6 text-center text-slate-400 text-sm bg-slate-50 border-t border-slate-100">
                            &copy; 2024 נדיה. נבנה באהבה.
                        </footer>

                        {/* Modals */}
                        {showSettings && <SettingsModal close={() => setShowSettings(false)} />}
                    </div>
                </AppContext.Provider>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
